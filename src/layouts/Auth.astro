---
import { actions } from "astro:actions";
import { AuthDialog } from "@/components/dialog/AuthDialog";

// if (Astro.locals.user === null || Astro.locals.session === null) {
//   return Astro.redirect("/login");
// }

const newPlinkoResult = Astro.getActionResult(actions.newPlinko);
if (newPlinkoResult && !newPlinkoResult.error) {
  Astro.redirect(`/digital/plinko/${newPlinkoResult.data.game.id}`);
}
---

<slot />

<script></script>

{Astro.locals.user === null || Astro.locals.session === null}

<AuthDialog
  client:load
  open={Astro.locals.user === null || Astro.locals.session === null}
/>
